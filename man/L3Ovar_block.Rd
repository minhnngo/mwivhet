% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/l3o_variance.R
\name{L3Ovar_block}
\alias{L3Ovar_block}
\title{Compute L3O Variance for Score Statistic (Balanced Block Design)}
\usage{
L3Ovar_block(X, e, P, c)
}
\arguments{
\item{X}{Numeric vector. The endogenous regressor.}

\item{e}{Numeric vector. The residual vector.}

\item{P}{Matrix. The \eqn{N \times N} projection matrix (assumed to be block-diagonal).}

\item{c}{Integer. The size of each block (group). Assumes \eqn{N} is a multiple of \eqn{c}.}
}
\value{
A numeric scalar representing the estimated variance.
}
\description{
Calculates the complete Leave-Three-Out (L3O) variance estimator for the score statistic
in the specific setting of a balanced block design (e.g., "Many Means" with equal group sizes).
This function optimizes computation by calculating the L3O geometry for a single block of
size \eqn{c} and replicating it across the full matrix.
}
\details{
This function implements the variance estimator \eqn{\hat{V}_{LM}} optimized for balanced designs.

\strong{Optimization:}
Instead of iterating through groups or observations, it exploits the fact that for balanced
groups, the Leave-Three-Out determinants and weight matrices are identical (up to permutation)
for every block. It constructs the necessary weight matrices (\code{recD3blockrep}) using
Kronecker products of a \eqn{c \times c} template.

\strong{Requirements:}
\itemize{
\item The data must be sorted by group.
\item Every group must have exactly \eqn{c} observations.
\item The projection matrix \eqn{P} must correspond to this block structure.
}
}

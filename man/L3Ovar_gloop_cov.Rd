% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/l3o_variance.R
\name{L3Ovar_gloop_cov}
\alias{L3Ovar_gloop_cov}
\title{Compute L3O Variance for Score Statistic (Grouped Design)}
\usage{
L3Ovar_gloop_cov(df, group, groupW, X, e, MX, Me)
}
\arguments{
\item{df}{Data frame. Contains the variables used in estimation.}

\item{group}{Column name (unquoted). The instrument grouping variable.}

\item{groupW}{Column name (unquoted). The covariate stratification variable.}

\item{X}{Column name (unquoted). The endogenous regressor.}

\item{e}{Column name (unquoted). Residuals under the null hypothesis (\eqn{Y - X\beta_0}).}

\item{MX}{Column name (unquoted). Leverage-adjusted regressor (\eqn{M_i X_i}).}

\item{Me}{Column name (unquoted). Leverage-adjusted residual (\eqn{M_i e_i}).}
}
\value{
Scalar. The estimated variance \eqn{\hat{V}_{LM}}.
}
\description{
Computes the Leave-Three-Out (L3O) variance estimator (\eqn{\hat{V}_{LM}}) for the score statistic
in a grouped instrument design with covariates. This function simultaneously calculates
all five variance components by exploiting the block-diagonal symmetry of the projection matrices
inherent to discrete instruments.
}
\details{
This function implements the variance estimator \eqn{\hat{V}_{LM}} for the Limited Information
Maximum Likelihood (LIML) or UJIVE estimator. It computes:
\deqn{\hat{V} = A_1 + 2A_2 + A_3 - A_4 - A_5}

Because the design implies symmetric weighting matrices (\eqn{G_{ij} = G_{ji}}), the function
simplifies the asymmetric components.

\strong{Components:}
\itemize{
\item \strong{A1, A2, A3}: Variance and covariance of the score statistic. Calculated via 5 sub-components each.
\item \strong{A4, A5}: Bias correction terms for "own-observation" variance contributions. Calculated via 4 sub-components each.
}
}

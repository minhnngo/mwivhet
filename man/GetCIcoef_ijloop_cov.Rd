% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inference.R
\name{GetCIcoef_ijloop_cov}
\alias{GetCIcoef_ijloop_cov}
\title{Compute Quadratic Coefficients for CI (Mega-Loop General)}
\usage{
GetCIcoef_ijloop_cov(
  X,
  Y,
  MX,
  MY,
  W,
  Q,
  WWWinv,
  QQQinv,
  IdPQ,
  IdPW,
  q = qnorm(0.975)^2,
  noisyi = TRUE,
  noisyj = FALSE
)
}
\arguments{
\item{X}{Numeric vector. The endogenous regressor.}

\item{Y}{Numeric vector. The outcome variable.}

\item{MX}{Numeric vector. The leverage-adjusted regressor \eqn{M X}.}

\item{MY}{Numeric vector. The leverage-adjusted outcome \eqn{M Y}.}

\item{W}{Matrix. The covariate matrix.}

\item{Q}{Matrix. The combined instrument and covariate matrix \eqn{[Z, W]}.}

\item{WWWinv}{Matrix. The matrix \eqn{W(W'W)^{-1}}.}

\item{QQQinv}{Matrix. The matrix \eqn{Q(Q'Q)^{-1}}.}

\item{IdPQ}{Numeric vector. The diagonal elements \eqn{1 - P_{Q,ii}}.}

\item{IdPW}{Numeric vector. The diagonal elements \eqn{1 - P_{W,ii}}.}

\item{q}{Numeric. The critical value for the test inversion (typically \eqn{1.96^2}).}

\item{noisyi}{Logical. If \code{TRUE}, prints progress for the outer loop.}

\item{noisyj}{Logical. If \code{TRUE}, prints progress for the inner loop.}
}
\value{
A numeric vector of length 3 containing \code{c(a, b, c)}.
}
\description{
Calculates the coefficients \eqn{(a, b, c)} for the confidence interval quadratic inequality
in the general asymmetric setting (e.g., UJIVE with continuous covariates). This function
is highly optimized for memory efficiency, performing a single nested loop over \eqn{(i, j)}
to compute all polynomial coefficients of the variance estimator \eqn{\hat{V}(\beta)} simultaneously.
}
\details{
This function is the "solver of last resort" for large datasets with complex designs.
It handles:
\enumerate{
\item \strong{Asymmetry:} Computes distinct row and column weights for \eqn{G}.
\item \strong{Memory Constraints:} Reconstructs projection vectors row-by-row using \code{Q} and \code{W},
never storing \eqn{N \times N} matrices.
\item \strong{Efficiency:} Computes all 30+ components required for \eqn{C_0, C_1, C_2} in a single pass.
}

The complexity is \eqn{O(N^3)} in time but \eqn{O(N)} in memory (beyond storing the basis matrices).
}
\references{
Yap, L. (2025). "Inference with Many Weak Instruments and Heterogeneity". Working Paper.
}

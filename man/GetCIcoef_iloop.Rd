% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inference.R
\name{GetCIcoef_iloop}
\alias{GetCIcoef_iloop}
\title{Compute Quadratic Coefficients for CI (General Design)}
\usage{
GetCIcoef_iloop(
  df,
  P,
  G,
  X,
  Y,
  MX,
  MY,
  Z,
  W,
  q = qnorm(0.975)^2,
  noisy = FALSE
)
}
\arguments{
\item{df}{Data frame. Contains the observable variables \eqn{X, Y} and their projections.}

\item{P}{Matrix of dimension n x n. The full projection matrix \eqn{P}.}

\item{G}{Matrix of dimension n x n. The UJIVE weighting matrix \eqn{G}.}

\item{X}{Column name (unquoted). The endogenous regressor.}

\item{Y}{Column name (unquoted). The outcome variable.}

\item{MX}{Column name (unquoted). Leverage-adjusted regressor (\eqn{M X}).}

\item{MY}{Column name (unquoted). Leverage-adjusted outcome (\eqn{M Y}).}

\item{Z}{Matrix of instruments.}

\item{W}{Matrix of covariates.}

\item{q}{Numeric scalar. Critical value for the test inversion (typically \eqn{1.96^2}).
Defaults to \code{qnorm(.975)^2} (approx. 3.84) for a 95 percent confidence interval.}

\item{noisy}{Logical. If \code{TRUE}, prints progress dots during calculation.
Defaults to \code{FALSE}.}
}
\value{
Numeric vector of length 3 containing \code{c(a, b, c)}.
}
\description{
Computes the coefficients \eqn{(a, b, c)} of the quadratic inequality \eqn{a\beta^2 + b\beta + c \leq 0}
used to construct confidence intervals for \eqn{\beta} in general instrumental variable designs.
This function supports asymmetric weighting matrices (e.g., UJIVE with continuous covariates)
by using the fully generalized \code{_iloop} variance estimators.
}
\details{
This is the most general version of the confidence interval coefficient calculator.
It does not assume symmetry of the weighting matrix \eqn{G}. Consequently, it computes
all five distinct variance components (\eqn{A_1} through \eqn{A_5}) for each term in the
polynomial expansion of \eqn{\hat{V}(\beta)}.

The returned coefficients define the curvature and position of the confidence set parabola:

The function explicitly constructs the diagonal adjustments for the UJIVE signal calculation
using the matrices \eqn{Z} and \eqn{W}.
}
\references{
Yap, L. (2025). "Inference with Many Weak Instruments and Heterogeneity". Working Paper.
}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inference.R
\name{GetSigMx}
\alias{GetSigMx}
\title{Compute Covariance Matrix of UJIVE Quadratic Forms}
\usage{
GetSigMx(df, groupW, group, X, Y, MX, MY, noisy = FALSE)
}
\arguments{
\item{df}{Data frame. Contains the variables used in estimation.}

\item{groupW}{Column name (unquoted). The covariate stratification variable.}

\item{group}{Column name (unquoted). The instrument grouping variable.}

\item{X}{Column name (unquoted). The endogenous regressor.}

\item{Y}{Column name (unquoted). The outcome variable.}

\item{MX}{Column name (unquoted). Leverage-adjusted regressor (\eqn{M X}).}

\item{MY}{Column name (unquoted). Leverage-adjusted outcome (\eqn{M Y}).}

\item{noisy}{Logical. If \code{TRUE}, prints progress during variance component calculation.
Defaults to \code{FALSE}.}
}
\value{
Numeric vector of length 6. Contains \code{c(sig11, sig22, sig33, sig12, sig23, sig13)}.
}
\description{
Estimates the joint variance-covariance matrix of the three core quadratic forms used in
UJIVE/LIML estimation: \eqn{Y'GY}, \eqn{X'GY}, and \eqn{X'GX}.
}
\details{
The function estimates the covariance components for the vector of quadratic forms:
\deqn{\Psi = [Y'GY, \quad X'GY, \quad X'GX]^T}

The returned vector contains the unique elements of the covariance matrix \eqn{\Sigma_\Psi}:
\itemize{
\item \code{sig11}: \eqn{Var(Y'GY)}
\item \code{sig22}: \eqn{Var(X'GY)}
\item \code{sig33}: \eqn{Var(X'GX)}
\item \code{sig12}: \eqn{Cov(Y'GY, X'GY)}
\item \code{sig23}: \eqn{Cov(X'GY, X'GX)}
\item \code{sig13}: \eqn{Cov(Y'GY, X'GX)}
}
}
\references{
Yap, L. (2025). "Inference with Many Weak Instruments and Heterogeneity". Working Paper.
}

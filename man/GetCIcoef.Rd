% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inference.R
\name{GetCIcoef}
\alias{GetCIcoef}
\title{Compute Quadratic Coefficients for Test Inversion Confidence Intervals (Clustered Data)}
\usage{
GetCIcoef(df, groupW, group, X, Y, MX, MY, q = qnorm(0.975)^2, noisy = FALSE)
}
\arguments{
\item{df}{Data frame. Contains the observable variables and their projections.}

\item{groupW}{Name of the covariate stratification variable (unquoted).}

\item{group}{Name of the instrument grouping variable (unquoted).}

\item{X}{Name of the endogenous regressor column (unquoted).}

\item{Y}{Name of the outcome variable column (unquoted).}

\item{MX}{Name of the column (unquoted) containing \eqn{M X} (leverage-adjusted regressor).}

\item{MY}{Name of the column (unquoted) containing \eqn{M Y} (leverage-adjusted outcome).}

\item{q}{Numeric. The critical value for the test statistic inversion (e.g., \eqn{\chi^2_{1, 1-\alpha}}).
Defaults to \code{qnorm(.975)^2} (approx. 3.84) for a 95 percent confidence interval.}

\item{noisy}{A logical indicating whether to print progress dots during the loop.
Defaults to \code{FALSE}.}
}
\value{
A numeric vector of length 3: \code{c(acon, bcon, ccon)}.
}
\description{
Estimates the coefficients \eqn{a}, \eqn{b}, and \eqn{c} for the quadratic inequality
\eqn{a\beta^2 + b\beta + c \le 0}, which defines the \eqn{1-\alpha} confidence set for the
structural parameter \eqn{\beta}. This function is designed for grouped/clustered data structures
and accounts for heteroskedasticity and many weak instruments.
}
\details{
The confidence set is constructed by inverting a test statistic (e.g., Anderson-Rubin or UJIVE-Wald)
based on the quadratic form \eqn{Q(\beta) = (\mathbf{Y} - \beta \mathbf{X})' G (\mathbf{Y} - \beta \mathbf{X})}.
The coefficients are derived from the variance estimator \eqn{\hat{V}(\beta)} of this quadratic form,
decomposed into three terms.

The final coefficients returned are:
\deqn{a = P_{XX}^2 - q \cdot C_2}
\deqn{b = -2 P_{XY} P_{XX} - q \cdot C_1}
\deqn{c = P_{XY}^2 - q \cdot C_0}

Where \eqn{P_{XY}} and \eqn{P_{XX}} are the UJIVE/Jackknife estimators for the numerator of the test statistic.
}
\references{
Yap, L. (2025). "Inference with Many Weak Instruments and Heterogeneity". Working Paper.
}

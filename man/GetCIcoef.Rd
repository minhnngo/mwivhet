% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/inference.R
\name{GetCIcoef}
\alias{GetCIcoef}
\title{Compute Quadratic Coefficients for Confidence Sets (Grouped Data)}
\usage{
GetCIcoef(df, groupW, group, X, Y, MX, MY, q = qnorm(0.975)^2, noisy = FALSE)
}
\arguments{
\item{df}{Data frame. Contains the observable variables and their projections.}

\item{groupW}{Column name (unquoted). The covariate stratification variable.}

\item{group}{Column name (unquoted). The instrument grouping variable.}

\item{X}{Column name (unquoted). The endogenous regressor.}

\item{Y}{Column name (unquoted). The outcome variable.}

\item{MX}{Column name (unquoted). Leverage-adjusted regressor (\eqn{M X}).}

\item{MY}{Column name (unquoted). Leverage-adjusted outcome (\eqn{M Y}).}

\item{q}{Numeric scalar. Critical value for the test statistic inversion (e.g., \eqn{\chi^2_{1, 1-\alpha}}).
Defaults to \code{qnorm(.975)^2} (approx. 3.84) for a 95 percent confidence interval.}

\item{noisy}{Logical. If \code{TRUE}, prints progress dots during calculation.
Defaults to \code{FALSE}.}
}
\value{
Numeric vector of length 3: \code{c(a, b, c)}.
}
\description{
Estimates the coefficients \eqn{a}, \eqn{b}, and \eqn{c} for the quadratic inequality
\eqn{a\beta^2 + b\beta + c \le 0}, which defines the \eqn{1-\alpha} confidence set for the
structural parameter \eqn{\beta}. Designed for grouped instrument structures with covariates.
}
\details{
The confidence set is constructed by inverting a test statistic based on the quadratic form
\eqn{Q(\beta) = (\mathbf{Y} - \beta \mathbf{X})' G (\mathbf{Y} - \beta \mathbf{X})}.
The coefficients are derived from the variance estimator \eqn{\hat{V}(\beta)} of this quadratic form,
decomposed into interactions between the outcome and the regressor.

The returned coefficients correspond to:
\deqn{a = P_{XX}^2 - q \cdot C_2}
\deqn{b = -2 P_{XY} P_{XX} - q \cdot C_1}
\deqn{c = P_{XY}^2 - q \cdot C_0}

Where \eqn{P_{XY}} and \eqn{P_{XX}} are the UJIVE estimators for the cross-products, and
\eqn{C_0, C_1, C_2} are the corresponding variance components computed via L3O adjustment.
}
\references{
Yap, L. (2025). "Inference with Many Weak Instruments and Heterogeneity".
}
